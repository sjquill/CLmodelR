pivot_longer(!time_period, names_to = "outcome", values_to = "number")  %>%
ggplot() +
geom_area(aes(x = time_period, y = number,
group = outcome, fill = outcome),
colour = "black", size = .2) +
scale_x_continuous(name = "") +
scale_y_continuous(name = "") + # , expand = c(0, 0), limits = c(0, NA)
theme_classic() +
theme(strip.background = element_blank()) +
scale_fill_brewer(palette = "Blues")
# second dataset - missing
readin_data <- read.csv("/Users/katehayes/temp_data/children-looked-after-in-england-including-adoptions_2021/data/la_children_who_were_missing_or_away_from_placement_during_the_year.csv")
care_outcomes_data <- readin_data
av_care_missing_data <- care_outcomes_data %>%
filter(la_name == "Birmingham") %>%
mutate(number = as.numeric(number)) %>%
filter(!is.na(number)) %>%
group_by(cla_group) %>%
summarise(av_number = mean(number)) %>%
kable("latex", booktabs = TRUE)
care_outcomes_data %>%
filter(la_name == "Birmingham") %>%
mutate(number = ifelse(number == "c" | number == "z", 0, number)) %>%
mutate(number = as.numeric(number)) %>%
pivot_wider(id_cols = time_period, names_from = cla_group, values_from = number) %>%
mutate(`Did not go missing` = `Children looked after during the year` - `Children who had a missing incident during the year`,
`Went missing once` = `Children who had a missing incident during the year` - `Children who went missing more than once during the year`) %>%
select(time_period, `Did not go missing`, `Went missing once`, `Children who went missing more than once during the year`) %>%
pivot_longer(!time_period, names_to = "missing", values_to = "number")  %>%
mutate(missing = fct_relevel(missing, "Children who went missing more than once during the year", "Went missing once", "Did not go missing")) %>%
ggplot() +
geom_area(aes(x = time_period, y = number,
group = missing, fill = fct_rev(missing)),
colour = "black", size = .2) +
scale_x_continuous(name = "") +
scale_y_continuous(name = "") + # , expand = c(0, 0), limits = c(0, NA)
theme_classic() +
theme(strip.background = element_blank()) +
scale_fill_brewer(palette = "PuRd")
#####################################################################################################
#########NEW DATA - time of inflow/outflow, duration######################################################################################################
#####################################################################################################
# INFLOW############################################################################################
readin_data <- read.csv("/Users/katehayes/temp_data/children-looked-after-in-england-including-adoptions_2021/data/la_children_who_started_to_be_looked_after_during_the_year.csv")
care_in_data <- readin_data
care_in_data %>%
filter(la_name == "Birmingham", cla_group == "Age group", characteristic != "Total") %>%
mutate(number = as.numeric(number)) %>%
mutate(characteristic = fct_relevel(characteristic,
"Under 1 year", "1 to 4 years", "5 to 9 years",
"10 to 15 years", "16 years and over")) %>%
ggplot() +
geom_area(aes(x = time_period, y = number,
group = characteristic, fill = characteristic)) +
scale_x_continuous(name = "") +
scale_y_continuous(name = "") +
theme_classic() +
theme(strip.background = element_blank())
ggsave(filename = "Output/Graphs/birm_care_in_byage.png")
care_in_data %>%
filter(la_name == "Birmingham", cla_group == "Gender", characteristic != "Total") %>%
mutate(number = as.numeric(number)) %>%
ggplot() +
geom_area(aes(x = time_period, y = number,
group = characteristic, fill = characteristic)) +
scale_x_continuous(name = "") +
scale_y_continuous(name = "", expand = c(0, 0), limits = c(0, NA)) +
theme_classic() +
theme(strip.background = element_blank())
ggsave(filename = "Output/Graphs/birm_care_in_bygender.png")
care_in_data %>%
filter(la_name == "Birmingham", cla_group == "Legal status", characteristic != "Total") %>% #
mutate(number = as.numeric(number)) %>%
ggplot() +
geom_line(aes(x = time_period, y = number,
group = characteristic, colour = characteristic)) +
scale_x_continuous(name = "") +
scale_y_continuous(name = "") + # , expand = c(0, 0), limits = c(0, NA)
theme_classic() +
theme(strip.background = element_blank())
care_in_data %>%
filter(la_name == "Birmingham", cla_group == "Legal status", characteristic != "Total") %>% #
mutate(number = as.numeric(number)) %>%
ggplot() +
geom_line(aes(x = time_period, y = number,
group = characteristic, colour = characteristic)) +
scale_x_continuous(name = "") +
scale_y_continuous(name = "") + # , expand = c(0, 0), limits = c(0, NA)
theme_classic() +
theme(strip.background = element_blank())
ggsave(filename = "Output/Graphs/birm_care_in_bylegal.png")
# REMANd!!!!
care_in_data %>%
filter(la_name == "Birmingham", cla_group == "Legal status", characteristic == "Remand") %>% #
mutate(number = as.numeric(number)) %>%
ggplot() +
geom_line(aes(x = time_period, y = number)) +
scale_x_continuous(name = "") +
scale_y_continuous(name = "", expand = c(0, 0), limits = c(0, NA)) + # , expand = c(0, 0), limits = c(0, NA)
theme_classic() +
theme(strip.background = element_blank())
ggsave(filename = "Output/Graphs/birm_headcount_remand.png")
care_in_data %>%
filter(la_name == "Birmingham", cla_group == "Category of need", characteristic != "Total") %>% #
mutate(number = as.numeric(number)) %>%
ggplot() +
geom_line(aes(x = time_period, y = number,
group = characteristic, colour = characteristic)) +
scale_x_continuous(name = "") +
scale_y_continuous(name = "") + # , expand = c(0, 0), limits = c(0, NA)
theme_classic() +
theme(strip.background = element_blank())
ggsave(filename = "Output/Graphs/birm_care_in_byneed.png")
readin_data <- read.csv("/Users/katehayes/temp_data/children-looked-after-in-england-including-adoptions_2021/data/la_children_who_ceased_during_the_year.csv")
care_out_data <- readin_data
care_out_data %>%
filter(la_name == "Birmingham", cla_group == "Age group", characteristic != "Total") %>%
mutate(number = as.numeric(number)) %>%
mutate(characteristic = fct_relevel(characteristic,
"Under 1 year", "1 to 4 years", "5 to 9 years",
"10 to 15 years", "16 years", "17 years", "18 years and over")) %>%
ggplot() +
geom_line(aes(x = time_period, y = number,
group = characteristic, colour = characteristic)) +
scale_x_continuous(name = "") +
scale_y_continuous(name = "") +
theme_classic() +
theme(strip.background = element_blank())
care_out_data %>%
filter(la_name == "Birmingham", cla_group == "Age group", characteristic != "Total") %>%
mutate(number = as.numeric(number)) %>%
mutate(characteristic = fct_relevel(characteristic,
"Under 1 year", "1 to 4 years", "5 to 9 years",
"10 to 15 years", "16 years", "17 years", "18 years and over")) %>%
ggplot() +
geom_area(aes(x = time_period, y = number,
group = characteristic, fill = characteristic)) +
scale_x_continuous(name = "") +
scale_y_continuous(name = "") +
theme_classic() +
theme(strip.background = element_blank())
care_out_data %>%
filter(la_name == "Birmingham", cla_group == "Age group", characteristic != "Total") %>%
mutate(number = as.numeric(number)) %>%
mutate(characteristic = fct_relevel(characteristic,
"Under 1 year", "1 to 4 years", "5 to 9 years",
"10 to 15 years", "16 years", "17 years", "18 years and over")) %>%
ggplot() +
geom_area(aes(x = time_period, y = number,
group = characteristic, fill = characteristic)) +
scale_x_continuous(name = "") +
scale_y_continuous(name = "") +
theme_classic() +
theme(strip.background = element_blank()) +
scale_fill_viridis(discrete = TRUE)
care_out_data %>%
filter(la_name == "Birmingham", cla_group == "Age group", characteristic != "Total") %>%
mutate(number = as.numeric(number)) %>%
mutate(characteristic = fct_relevel(characteristic,
"Under 1 year", "1 to 4 years", "5 to 9 years",
"10 to 15 years", "16 years", "17 years", "18 years and over")) %>%
ggplot() +
geom_area(aes(x = time_period, y = number,
group = characteristic, fill = characteristic)) +
scale_x_continuous(name = "") +
scale_y_continuous(name = "") +
theme_classic() +
theme(strip.background = element_blank()) +
scale_fill_viridis(discrete = TRUE, , direction = -1)
care_out_data %>%
filter(la_name == "Birmingham", cla_group == "Age group", characteristic != "Total") %>%
mutate(number = as.numeric(number)) %>%
mutate(characteristic = fct_relevel(characteristic,
"Under 1 year", "1 to 4 years", "5 to 9 years",
"10 to 15 years", "16 years", "17 years", "18 years and over")) %>%
ggplot() +
geom_area(aes(x = time_period, y = number,
group = characteristic, fill = characteristic)) +
scale_x_continuous(name = "") +
scale_y_continuous(name = "") +
theme_classic() +
theme(strip.background = element_blank()) +
scale_fill_viridis(discrete = TRUE, direction = -1)
ggsave(filename = "Output/Graphs/birm_care_out_byage.png")
care_in_data %>%
filter(la_name == "Birmingham", cla_group == "Age group", characteristic != "Total") %>%
mutate(number = as.numeric(number)) %>%
mutate(characteristic = fct_relevel(characteristic,
"Under 1 year", "1 to 4 years", "5 to 9 years",
"10 to 15 years", "16 years and over")) %>%
ggplot() +
geom_area(aes(x = time_period, y = number,
group = characteristic, fill = characteristic)) +
scale_x_continuous(name = "") +
scale_y_continuous(name = "") +
theme_classic() +
theme(strip.background = element_blank()) +
scale_fill_viridis(discrete = TRUE, direction = -1)
ggsave(filename = "Output/Graphs/birm_care_in_byage.png")
care_out_data %>%
filter(la_name == "Birmingham", cla_group == "Gender", characteristic != "Total") %>%
mutate(number = as.numeric(number)) %>%
ggplot() +
geom_line(aes(x = time_period, y = number,
group = characteristic, colour = characteristic)) +
scale_x_continuous(name = "") +
scale_y_continuous(name = "", expand = c(0, 0), limits = c(0, NA)) +
theme_classic() +
theme(strip.background = element_blank())
care_out_data %>%
filter(la_name == "Birmingham", cla_group == "Gender", characteristic != "Total") %>%
mutate(number = as.numeric(number)) %>%
ggplot() +
geom_area(aes(x = time_period, y = number,
group = characteristic, colour = fill)) +
scale_x_continuous(name = "") +
scale_y_continuous(name = "", expand = c(0, 0), limits = c(0, NA)) +
theme_classic() +
theme(strip.background = element_blank())
care_out_data %>%
filter(la_name == "Birmingham", cla_group == "Gender", characteristic != "Total") %>%
mutate(number = as.numeric(number)) %>%
ggplot() +
geom_area(aes(x = time_period, y = number,
group = characteristic, fill = characteristic)) +
scale_x_continuous(name = "") +
scale_y_continuous(name = "", expand = c(0, 0), limits = c(0, NA)) +
theme_classic() +
theme(strip.background = element_blank())
care_out_data %>%
filter(la_name == "Birmingham", cla_group == "Gender", characteristic != "Total") %>%
mutate(number = as.numeric(number)) %>%
ggplot() +
geom_area(aes(x = time_period, y = number,
group = characteristic, fill = characteristic)) +
scale_x_continuous(name = "") +
scale_y_continuous(name = "") +
theme_classic() +
theme(strip.background = element_blank())
ggsave(filename = "Output/Graphs/birm_care_out_bygender.png")
care_out_data %>%
filter(la_name == "Birmingham", cla_group == "Reason episode ceased", characteristic == "Sentenced to custody") %>%
mutate(number = as.numeric(number)) %>%
ggplot() +
geom_line(aes(x = time_period, y = number)) +
scale_x_continuous(name = "") +
scale_y_continuous(name = "", expand = c(0, 0), limits = c(0, NA)) +
theme_classic() +
theme(strip.background = element_blank())
ggsave(filename = "Output/Graphs/birm_headcount_care2custody.png")
care_out_data %>%
filter(la_name == "Birmingham", cla_group == "Reason episode ceased") %>%
mutate(number = as.numeric(number)) %>%
ggplot() +
geom_area(aes(x = time_period, y = number, fill = characteristic)) +
scale_x_continuous(name = "") +
scale_y_continuous(name = "") +
theme_classic() +
theme(strip.background = element_blank())
care_out_data %>%
filter(la_name == "Birmingham", cla_group == "Reason episode ceased", characteristic != "Total") %>%
mutate(number = as.numeric(number)) %>%
ggplot() +
geom_linr(aes(x = time_period, y = number, colour = characteristic)) +
scale_x_continuous(name = "") +
scale_y_continuous(name = "") +
theme_classic() +
theme(strip.background = element_blank())
care_out_data %>%
filter(la_name == "Birmingham", cla_group == "Reason episode ceased", characteristic != "Total") %>%
mutate(number = as.numeric(number)) %>%
ggplot() +
geom_linr(aes(x = time_period, y = number, colour = characteristic)) +
scale_x_continuous(name = "") +
scale_y_continuous(name = "") +
theme_classic() +
theme(strip.background = element_blank())
care_out_data %>%
filter(la_name == "Birmingham", cla_group == "Reason episode ceased", characteristic != "Total") %>%
mutate(number = as.numeric(number)) %>%
ggplot() +
geom_line(aes(x = time_period, y = number, colour = characteristic)) +
scale_x_continuous(name = "") +
scale_y_continuous(name = "") +
theme_classic() +
theme(strip.background = element_blank())
ggsave(filename = "Output/Graphs/birm_care_out_byreason.png")
readin_data <- read.csv("/Users/katehayes/temp_data/children-looked-after-in-england-including-adoptions_2021/data/national_duration_of_placement_ceasing_during_the_year.csv")
care_duration_data <- readin_data
care_duration_data %>%
filter(placement_group == "Secure units, childrenâ€™s homes and semi-independent living accommodation") %>%
filter(substr(placement_duration, start = 2, stop = 2) == ".") %>%
group_by(placement_duration, time_period) %>%
mutate(number = as.numeric(number)) %>%
summarise(number = number) %>%
ggplot() +
geom_line(aes(x = placement_duration, y = number,
group = time_period, colour = time_period)) +
scale_x_discrete(name = "") +
scale_y_continuous(name = "") +
theme_classic() +
theme(strip.background = element_blank(), axis.text.x=element_text(angle = -35, hjust = 0)) +
scale_colour_viridis(option = "viridis", discrete = FALSE)
ggsave(filename = "Output/Graphs/eng_headcount_care_duration_yearly.png")
#########rNEW DATA - repeat episodes of care######################################################################################################
readin_data <- read.csv("/Users/katehayes/temp_data/children-looked-after-in-england-including-adoptions_2021/data/national_cla_ceased_during_year_placements_care_periods.csv")
care_repeat_data <- readin_data
care_repeat_data %>%
filter(cla_group == "Number of periods of care", periods_or_placements != "Total",
periods_or_placements != "10 or more",
age_on_ceasing != "Total",  age_on_ceasing != "Under 1 year",  age_on_ceasing != "1 to 4 years",  age_on_ceasing != "5 to 9 years",) %>%
group_by(age_on_ceasing, periods_or_placements, time_period) %>%
mutate(number = as.numeric(number)) %>%
summarise(number = number) %>%
mutate(number = if_else(is.na(number), 0, number)) %>%
ggplot() +
geom_line(aes(x = periods_or_placements, y = number,
group = age_on_ceasing, colour = age_on_ceasing)) +
facet_wrap(~time_period) +
scale_x_discrete(name = "") +
scale_y_continuous(name = "") +
theme_classic() +
theme(strip.background = element_blank(), axis.text.x=element_text(angle = -35, hjust = 0)) +
scale_colour_viridis(option = "viridis", discrete = TRUE)
care_repeat_data %>%
filter(cla_group == "Number of periods of care", periods_or_placements != "Total",
periods_or_placements != "10 or more",
age_on_ceasing != "Total",  age_on_ceasing != "Under 1 year",  age_on_ceasing != "1 to 4 years",  age_on_ceasing != "5 to 9 years",) %>%
group_by(age_on_ceasing, periods_or_placements, time_period) %>%
mutate(number = as.numeric(number)) %>%
summarise(number = number) %>%
mutate(number = if_else(is.na(number), 0, number)) %>%
ggplot() +
geom_line(aes(x = age_on_ceasing, y = number,
group = periods_or_placements , colour = periods_or_placements)) +
facet_wrap(~time_period) +
scale_x_discrete(name = "") +
scale_y_continuous(name = "") +
theme_classic() +
theme(strip.background = element_blank(), axis.text.x=element_text(angle = -35, hjust = 0)) +
scale_colour_viridis(option = "viridis", discrete = TRUE)
care_repeat_data %>%
filter(cla_group == "Number of periods of care", periods_or_placements != "Total",
periods_or_placements != "10 or more",
age_on_ceasing != "Total",  age_on_ceasing != "Under 1 year",  age_on_ceasing != "1 to 4 years",  age_on_ceasing != "5 to 9 years",) %>%
group_by(age_on_ceasing, periods_or_placements, time_period) %>%
mutate(number = as.numeric(number)) %>%
summarise(number = number) %>%
mutate(number = if_else(is.na(number), 0, number)) %>%
ggplot() +
geom_bar(aes(x = age_on_ceasing, y = number,
group = periods_or_placements , colour = periods_or_placements)) +
facet_wrap(~time_period) +
scale_x_discrete(name = "") +
scale_y_continuous(name = "") +
theme_classic() +
theme(strip.background = element_blank(), axis.text.x=element_text(angle = -35, hjust = 0)) +
scale_colour_viridis(option = "viridis", discrete = TRUE)
care_repeat_data %>%
filter(cla_group == "Number of periods of care", periods_or_placements != "Total",
periods_or_placements != "10 or more",
age_on_ceasing != "Total",  age_on_ceasing != "Under 1 year",  age_on_ceasing != "1 to 4 years",  age_on_ceasing != "5 to 9 years",) %>%
group_by(age_on_ceasing, periods_or_placements, time_period) %>%
mutate(number = as.numeric(number)) %>%
summarise(number = number) %>%
mutate(number = if_else(is.na(number), 0, number)) %>%
ggplot() +
geom_bar(aes(x = age_on_ceasing, y = number,
group = periods_or_placements)) +
facet_wrap(~time_period) +
scale_x_discrete(name = "") +
scale_y_continuous(name = "") +
theme_classic() +
theme(strip.background = element_blank(), axis.text.x=element_text(angle = -35, hjust = 0)) +
scale_colour_viridis(option = "viridis", discrete = TRUE)
care_repeat_data %>%
filter(cla_group == "Number of periods of care", periods_or_placements != "Total",
periods_or_placements != "10 or more",
age_on_ceasing != "Total",  age_on_ceasing != "Under 1 year",  age_on_ceasing != "1 to 4 years",  age_on_ceasing != "5 to 9 years",) %>%
group_by(age_on_ceasing, periods_or_placements, time_period) %>%
mutate(number = as.numeric(number)) %>%
summarise(number = number) %>%
mutate(number = if_else(is.na(number), 0, number)) %>%
ggplot() +
geom_bar(aes(x = age_on_ceasing, y = number,
fill = periods_or_placements)) +
facet_wrap(~time_period) +
scale_x_discrete(name = "") +
scale_y_continuous(name = "") +
theme_classic() +
theme(strip.background = element_blank(), axis.text.x=element_text(angle = -35, hjust = 0)) +
scale_colour_viridis(option = "viridis", discrete = TRUE)
care_repeat_data %>%
filter(cla_group == "Number of periods of care", periods_or_placements != "Total",
periods_or_placements != "10 or more",
age_on_ceasing != "Total",  age_on_ceasing != "Under 1 year",  age_on_ceasing != "1 to 4 years",  age_on_ceasing != "5 to 9 years",) %>%
group_by(age_on_ceasing, periods_or_placements, time_period) %>%
mutate(number = as.numeric(number)) %>%
summarise(number = number) %>%
mutate(number = if_else(is.na(number), 0, number)) %>%
ggplot() +
geom_bar(aes(x = age_on_ceasing, y = number,
fill = periods_or_placements), position="dodge", stat="identity") +
facet_wrap(~time_period) +
scale_x_discrete(name = "") +
scale_y_continuous(name = "") +
theme_classic() +
theme(strip.background = element_blank(), axis.text.x=element_text(angle = -35, hjust = 0)) +
scale_colour_viridis(option = "viridis", discrete = TRUE)
care_repeat_data %>%
filter(cla_group == "Number of periods of care", periods_or_placements != "Total",
periods_or_placements != "10 or more",
age_on_ceasing != "Total",  age_on_ceasing != "Under 1 year",  age_on_ceasing != "1 to 4 years",  age_on_ceasing != "5 to 9 years",) %>%
group_by(age_on_ceasing, periods_or_placements, time_period) %>%
mutate(number = as.numeric(number)) %>%
summarise(number = number) %>%
mutate(number = if_else(is.na(number), 0, number)) %>%
ggplot() +
geom_bar(aes(x = age_on_ceasing, y = number,
fill = periods_or_placements), position="stack", stat="identity") +
facet_wrap(~time_period) +
scale_x_discrete(name = "") +
scale_y_continuous(name = "") +
theme_classic() +
theme(strip.background = element_blank(), axis.text.x=element_text(angle = -35, hjust = 0)) +
scale_colour_viridis(option = "viridis", discrete = TRUE)
care_repeat_data %>%
filter(cla_group == "Number of periods of care", periods_or_placements != "Total",
periods_or_placements != "10 or more",
age_on_ceasing != "Total",  age_on_ceasing != "Under 1 year",  age_on_ceasing != "1 to 4 years",  age_on_ceasing != "5 to 9 years",) %>%
group_by(age_on_ceasing, periods_or_placements, time_period) %>%
mutate(number = as.numeric(number)) %>%
summarise(number = number) %>%
mutate(number = if_else(is.na(number), 0, number)) %>%
ggplot() +
geom_bar(aes(x = age_on_ceasing, y = number,
fill = fct_rev(periods_or_placements)), position="stack", stat="identity") +
facet_wrap(~time_period) +
scale_x_discrete(name = "") +
scale_y_continuous(name = "") +
theme_classic() +
theme(strip.background = element_blank(), axis.text.x=element_text(angle = -35, hjust = 0)) +
scale_colour_viridis(option = "viridis", discrete = TRUE)
care_repeat_data %>%
filter(cla_group == "Number of periods of care", periods_or_placements != "Total",
periods_or_placements != "10 or more",
age_on_ceasing != "Total",  age_on_ceasing != "Under 1 year",  age_on_ceasing != "1 to 4 years",  age_on_ceasing != "5 to 9 years",) %>%
group_by(age_on_ceasing, periods_or_placements, time_period) %>%
mutate(number = as.numeric(number)) %>%
summarise(number = number) %>%
mutate(number = if_else(is.na(number), 0, number)) %>%
ggplot() +
geom_bar(aes(x = age_on_ceasing, y = number,
fill = fct_rev(periods_or_placements)), position="stack", stat="identity") +
facet_wrap(~time_period) +
scale_x_discrete(name = "") +
scale_y_continuous(name = "") +
theme_classic() +
scale_colour_viridis(option = "viridis", discrete = TRUE) +
theme(strip.background = element_blank(), axis.text.x=element_text(angle = -35, hjust = 0))
care_repeat_data %>%
filter(cla_group == "Number of periods of care", periods_or_placements != "Total",
periods_or_placements != "10 or more",
age_on_ceasing != "Total",  age_on_ceasing != "Under 1 year",  age_on_ceasing != "1 to 4 years",  age_on_ceasing != "5 to 9 years",) %>%
group_by(age_on_ceasing, periods_or_placements, time_period) %>%
mutate(number = as.numeric(number)) %>%
summarise(number = number) %>%
mutate(number = if_else(is.na(number), 0, number)) %>%
ggplot() +
geom_bar(aes(x = age_on_ceasing, y = number,
fill = fct_rev(periods_or_placements)), position="stack", stat="identity") +
facet_wrap(~time_period) +
scale_x_discrete(name = "") +
scale_y_continuous(name = "") +
theme_classic() +
scale_fill_viridis(option = "viridis", discrete = TRUE) +
theme(strip.background = element_blank(), axis.text.x=element_text(angle = -35, hjust = 0))
care_repeat_data %>%
filter(cla_group == "Number of periods of care", periods_or_placements != "Total",
periods_or_placements != "10 or more",
age_on_ceasing != "Total",  age_on_ceasing != "Under 1 year",  age_on_ceasing != "1 to 4 years",  age_on_ceasing != "5 to 9 years",) %>%
group_by(age_on_ceasing, periods_or_placements, time_period) %>%
mutate(number = as.numeric(number)) %>%
summarise(number = number) %>%
mutate(number = if_else(is.na(number), 0, number)) %>%
ggplot() +
geom_bar(aes(x = age_on_ceasing, y = number,
fill = fct_rev(periods_or_placements)), position="stack", stat="identity") +
facet_wrap(~time_period) +
scale_x_discrete(name = "") +
scale_y_continuous(name = "") +
theme_classic() +
scale_fill_viridis(option = "viridis", discrete = TRUE, direction = -1) +
theme(strip.background = element_blank(), axis.text.x=element_text(angle = -35, hjust = 0))
care_repeat_data %>%
filter(cla_group == "Number of periods of care", periods_or_placements != "Total",
periods_or_placements != "10 or more",
age_on_ceasing != "Total",  age_on_ceasing != "Under 1 year",  age_on_ceasing != "1 to 4 years",  age_on_ceasing != "5 to 9 years",) %>%
group_by(age_on_ceasing, periods_or_placements, time_period) %>%
mutate(number = as.numeric(number)) %>%
summarise(number = number) %>%
mutate(number = if_else(is.na(number), 0, number)) %>%
ggplot() +
geom_bar(aes(x = age_on_ceasing, y = number,
fill = fct_rev(periods_or_placements)), position="stack", stat="identity") +
facet_wrap(~time_period) +
scale_x_discrete(name = "") +
scale_y_continuous(name = "") +
theme_classic() +
scale_fill_viridis(option = "viridis", discrete = TRUE) +
theme(strip.background = element_blank(), axis.text.x=element_text(angle = -35, hjust = 0))
ggsave(filename = "Output/Graphs/eng_headcount_care_duration_yearly.png")
