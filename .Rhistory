scale_fill_viridis(discrete = TRUE, direction = -1)
library(viridis)
care_data %>%
filter(la_name == "Birmingham", cla_group == "Age group", characteristic != "Total") %>%
mutate(number = as.numeric(number)) %>%
mutate(characteristic = fct_relevel(characteristic,
"Under 1 year", "1 to 4 years", "5 to 9 years",
"10 to 15 years", "16 years and over")) %>%
ggplot() +
geom_area(aes(x = time_period, y = number,
group = characteristic, fill = characteristic)) +
scale_x_continuous(name = "") +
scale_y_continuous(name = "") +
theme_classic() +
theme(strip.background = element_blank()) +
scale_fill_viridis(discrete = TRUE, direction = -1)
care_data %>%
filter(la_name == "Birmingham", cla_group == "Age group", characteristic != "Total") %>%
mutate(number = as.numeric(number)) %>%
mutate(characteristic = fct_relevel(characteristic,
"Under 1 year", "1 to 4 years", "5 to 9 years",
"10 to 15 years", "16 years and over")) %>%
ggplot() +
geom_area(aes(x = time_period, y = number,
group = characteristic, fill = fct_rev(characteristic))) +
scale_x_continuous(name = "") +
scale_y_continuous(name = "") +
theme_classic() +
theme(strip.background = element_blank()) +
scale_fill_viridis(discrete = TRUE, direction = -1)
care_data %>%
filter(la_name == "Birmingham", cla_group == "Age group", characteristic != "Total") %>%
mutate(number = as.numeric(number)) %>%
mutate(characteristic = fct_relevel(characteristic,
"Under 1 year", "1 to 4 years", "5 to 9 years",
"10 to 15 years", "16 years and over")) %>%
ggplot() +
geom_area(aes(x = time_period, y = number,
group = fct_rev(characteristic), fill = fct_rev(characteristic))) +
scale_x_continuous(name = "") +
scale_y_continuous(name = "") +
theme_classic() +
theme(strip.background = element_blank()) +
scale_fill_viridis(discrete = TRUE, direction = -1)
care_data %>%
filter(la_name == "Birmingham", cla_group == "Age group", characteristic != "Total") %>%
mutate(number = as.numeric(number)) %>%
mutate(characteristic = fct_relevel(characteristic,
"Under 1 year", "1 to 4 years", "5 to 9 years",
"10 to 15 years", "16 years and over")) %>%
ggplot() +
geom_area(aes(x = time_period, y = number,
group = fct_rev(characteristic), fill = characteristic)) +
scale_x_continuous(name = "") +
scale_y_continuous(name = "") +
theme_classic() +
theme(strip.background = element_blank()) +
scale_fill_viridis(discrete = TRUE, direction = -1)
ggsave(filename = "Output/Graphs/birm_care_byage.png")
care_data %>%
filter(la_name == "Birmingham", cla_group == "Gender", characteristic != "Total") %>%
mutate(number = as.numeric(number)) %>%
ggplot() +
geom_area(aes(x = time_period, y = number,
group = characteristic, fill = characteristic)) +
scale_x_continuous(name = "") +
scale_y_continuous(name = "", expand = c(0, 0), limits = c(0, NA)) +
theme_classic() +
theme(strip.background = element_blank())
care_data %>%
filter(la_name == "Birmingham", cla_group == "Placement", characteristic != "Total") %>% #
mutate(number = as.numeric(number)) %>%
ggplot() +
geom_line(aes(x = time_period, y = number,
group = characteristic, colour = characteristic)) +
scale_x_continuous(name = "") +
scale_y_continuous(name = "") + # , expand = c(0, 0), limits = c(0, NA)
theme_classic() +
theme(strip.background = element_blank())
care_data %>%
filter(la_name == "Birmingham", cla_group == "Placement", characteristic != "Total") %>% #
mutate(number = as.numeric(number)) %>%
filter(!is.na(number)) %>%
mutate(residential = if_else(characteristic == "Residential schools" |
characteristic == "Other residential settings" |
characteristic == "Secure units, children's homes and semi-independent living accommodation",
"residential", "non-residential")) %>%
group_by(residential, time_period) %>%
mutate(res_number = sum(number)) %>%
ggplot() +
geom_line(aes(x = time_period, y = res_number,
group = residential, colour = residential)) +
scale_x_continuous(name = "") +
scale_y_continuous(name = "") + # , expand = c(0, 0), limits = c(0, NA)
theme_classic() +
theme(strip.background = element_blank())
care_data %>%
filter(la_name == "Birmingham", cla_group == "Placement", characteristic != "Total") %>% #
mutate(number = as.numeric(number)) %>%
filter(!is.na(number)) %>%
mutate(residential = if_else(characteristic == "Residential schools" |
characteristic == "Other residential settings" |
characteristic == "Secure units, children's homes and semi-independent living accommodation",
"residential", "non-residential")) %>%
group_by(residential, time_period) %>%
mutate(res_number = sum(number)) %>%
ggplot() +
geom_area(aes(x = time_period, y = res_number,
group = residential, colour = residential)) +
scale_x_continuous(name = "") +
scale_y_continuous(name = "") + # , expand = c(0, 0), limits = c(0, NA)
theme_classic() +
theme(strip.background = element_blank())
care_data %>%
filter(la_name == "Birmingham", cla_group == "Placement", characteristic != "Total") %>% #
mutate(number = as.numeric(number)) %>%
filter(!is.na(number)) %>%
mutate(residential = if_else(characteristic == "Residential schools" |
characteristic == "Other residential settings" |
characteristic == "Secure units, children's homes and semi-independent living accommodation",
"residential", "non-residential")) %>%
group_by(residential, time_period) %>%
mutate(res_number = sum(number)) %>%
ggplot() +
geom_area(aes(x = time_period, y = number,
group = residential, colour = residential)) +
scale_x_continuous(name = "") +
scale_y_continuous(name = "") + # , expand = c(0, 0), limits = c(0, NA)
theme_classic() +
theme(strip.background = element_blank())
care_data %>%
filter(la_name == "Birmingham", cla_group == "Placement", characteristic != "Total") %>% #
mutate(number = as.numeric(number)) %>%
ggplot() +
geom_line(aes(x = time_period, y = number,
group = characteristic, colour = characteristic)) +
scale_x_continuous(name = "") +
scale_y_continuous(name = "") + # , expand = c(0, 0), limits = c(0, NA)
theme_classic() +
theme(strip.background = element_blank())
care_data %>%
filter(la_name == "Birmingham", cla_group == "Placement", characteristic != "Total") %>% #
mutate(number = as.numeric(number)) %>%
ggplot() +
geom_area(aes(x = time_period, y = number,
group = characteristic, colour = characteristic)) +
scale_x_continuous(name = "") +
scale_y_continuous(name = "") + # , expand = c(0, 0), limits = c(0, NA)
theme_classic() +
theme(strip.background = element_blank())
care_data %>%
filter(la_name == "Birmingham", cla_group == "Placement", characteristic != "Total") %>% #
mutate(number = as.numeric(number)) %>%
ggplot() +
geom_area(aes(x = time_period, y = number,
group = characteristic, fill = characteristic)) +
scale_x_continuous(name = "") +
scale_y_continuous(name = "") + # , expand = c(0, 0), limits = c(0, NA)
theme_classic() +
theme(strip.background = element_blank())
care_data %>%
filter(la_name == "Birmingham", cla_group == "Placement", characteristic != "Total") %>% #
filter(characteristic != "Other placements in the community", characteristic != "Other residential settings") %>% #
mutate(number = as.numeric(number)) %>%
ggplot() +
geom_area(aes(x = time_period, y = number,
group = characteristic, fill = characteristic)) +
scale_x_continuous(name = "") +
scale_y_continuous(name = "") + # , expand = c(0, 0), limits = c(0, NA)
theme_classic() +
theme(strip.background = element_blank())
care_data %>%
filter(la_name == "Birmingham", cla_group == "Placement", characteristic != "Total") %>% #
filter(characteristic != "Other placements in the community", characteristic != "Other residential settings", characteristic != "Other placements") %>% #
mutate(number = as.numeric(number)) %>%
ggplot() +
geom_area(aes(x = time_period, y = number,
group = characteristic, fill = characteristic)) +
scale_x_continuous(name = "") +
scale_y_continuous(name = "") + # , expand = c(0, 0), limits = c(0, NA)
theme_classic() +
theme(strip.background = element_blank())
care_data %>%
filter(la_name == "Birmingham", cla_group == "Placement", characteristic != "Total") %>% #
filter(characteristic != "Other placements in the community", characteristic != "Other residential settings", characteristic != "Other placements") %>% #
mutate(number = as.numeric(number)) %>%
ggplot() +
geom_area(aes(x = time_period, y = number,
group = characteristic, fill = characteristic)) +
scale_x_continuous(name = "") +
scale_y_continuous(name = "") + # , expand = c(0, 0), limits = c(0, NA)
theme_classic() +
theme(strip.background = element_blank()) +
scale_fill_brewer(palette = "Blues")
care_data %>%
filter(la_name == "Birmingham", cla_group == "Placement", characteristic != "Total") %>% #
filter(characteristic != "Other placements in the community", characteristic != "Other residential settings", characteristic != "Other placements") %>% #
mutate(number = as.numeric(number)) %>%
ggplot() +
geom_area(aes(x = time_period, y = number,
group = characteristic, fill = characteristic,
colour = "black", size = .2)) +
scale_x_continuous(name = "") +
scale_y_continuous(name = "") + # , expand = c(0, 0), limits = c(0, NA)
theme_classic() +
theme(strip.background = element_blank()) +
scale_fill_brewer(palette = "Blues")
care_data %>%
filter(la_name == "Birmingham", cla_group == "Placement", characteristic != "Total") %>% #
filter(characteristic != "Other placements in the community", characteristic != "Other residential settings", characteristic != "Other placements") %>% #
mutate(number = as.numeric(number)) %>%
ggplot() +
geom_area(aes(x = time_period, y = number,
group = characteristic, fill = characteristic),
colour = "black", size = .2)) +
care_data %>%
filter(la_name == "Birmingham", cla_group == "Placement", characteristic != "Total") %>% #
filter(characteristic != "Other placements in the community", characteristic != "Other residential settings", characteristic != "Other placements") %>% #
mutate(number = as.numeric(number)) %>%
ggplot() +
geom_area(aes(x = time_period, y = number,
group = characteristic, fill = characteristic),
colour = "black", size = .2) +
scale_x_continuous(name = "") +
scale_y_continuous(name = "") + # , expand = c(0, 0), limits = c(0, NA)
theme_classic() +
theme(strip.background = element_blank()) +
scale_fill_brewer(palette = "Blues")
care_data %>%
filter(la_name == "Birmingham", cla_group == "Placement", characteristic != "Total") %>% #
filter(characteristic != "Other placements in the community", characteristic != "Other residential settings", characteristic != "Other placements") %>% #
mutate(number = as.numeric(number)) %>%
ggplot() +
geom_area(aes(x = time_period, y = number,
group = fct_reorder(characteristic, number, max), fill = characteristic),
colour = "black", size = .2) +
scale_x_continuous(name = "") +
scale_y_continuous(name = "") + # , expand = c(0, 0), limits = c(0, NA)
theme_classic() +
theme(strip.background = element_blank()) +
scale_fill_brewer(palette = "Blues")
care_data %>%
filter(la_name == "Birmingham", cla_group == "Placement", characteristic != "Total") %>% #
filter(characteristic != "Other placements in the community", characteristic != "Other residential settings", characteristic != "Other placements") %>% #
mutate(number = as.numeric(number)) %>%
ggplot() +
geom_area(aes(x = time_period, y = number,
group = fct_reorder(characteristic, number, max), fill = fct_reorder(characteristic, number, max)),
colour = "black", size = .2) +
scale_x_continuous(name = "") +
scale_y_continuous(name = "") + # , expand = c(0, 0), limits = c(0, NA)
theme_classic() +
theme(strip.background = element_blank()) +
scale_fill_brewer(palette = "Blues")
ggsave(filename = "Output/Graphs/birm_care_byplacetype.png")
#####################################################################################################
#########NEW DATA - OUTCOMES######################################################################################################
#####################################################################################################
# second dataset - convictions
readin_data <- read.csv("/Users/katehayes/temp_data/children-looked-after-in-england-including-adoptions_2021/data/la_conviction_and_health_outcomes_cla.csv")
care_outcomes_data <- readin_data
av_care_convict_data <- care_outcomes_data %>%
filter(la_name == "Birmingham", cla_group == "Convictions: Children looked after Ages 10 to 17 years") %>%
group_by(outcome) %>%
mutate(number = as.numeric(number)) %>%
summarise(av_number = mean(number)) %>%
kable("latex", booktabs = TRUE)
av_care_convict_data <- care_outcomes_data %>%
filter(la_name == "Birmingham", cla_group == "Convictions: Children looked after Ages 10 to 17 years") %>%
group_by(outcome) %>%
mutate(number = as.numeric(number)) %>%
summarise(av_number = mean(number))
View(av_care_convict_data)
View(care_outcomes_data)
care_outcomes_data %>%
filter(la_name == "Birmingham", cla_group == "Convictions: Children looked after Ages 10 to 17 years") %>%
ggplot() +
geom_area(aes(x = time_period, y = number,
group = outcome, fill = outcome),
colour = "black", size = .2) +
scale_x_continuous(name = "") +
scale_y_continuous(name = "") + # , expand = c(0, 0), limits = c(0, NA)
theme_classic() +
theme(strip.background = element_blank()) +
scale_fill_brewer(palette = "Blues")
care_outcomes_data %>%
filter(la_name == "Birmingham", cla_group == "Convictions: Children looked after Ages 10 to 17 years") %>%
mutate(number = if_else(number == "c", 0, number)) %>%
mutate(number = as.numeric(number)) %>%
ggplot() +
geom_area(aes(x = time_period, y = number,
group = outcome, fill = outcome),
colour = "black", size = .2) +
scale_x_continuous(name = "") +
scale_y_continuous(name = "") + # , expand = c(0, 0), limits = c(0, NA)
theme_classic() +
theme(strip.background = element_blank()) +
scale_fill_brewer(palette = "Blues")
care_outcomes_data %>%
filter(la_name == "Birmingham", cla_group == "Convictions: Children looked after Ages 10 to 17 years") %>%
mutate(number = ifelse(number == "c", 0, number)) %>%
mutate(number = as.numeric(number)) %>%
ggplot() +
geom_area(aes(x = time_period, y = number,
group = outcome, fill = outcome),
colour = "black", size = .2) +
scale_x_continuous(name = "") +
scale_y_continuous(name = "") + # , expand = c(0, 0), limits = c(0, NA)
theme_classic() +
theme(strip.background = element_blank()) +
scale_fill_brewer(palette = "Blues")
check <- care_outcomes_data %>%
filter(la_name == "Birmingham", cla_group == "Convictions: Children looked after Ages 10 to 17 years") %>%
mutate(number = ifelse(number == "c", 0, number)) %>%
mutate(number = as.numeric(number)) %>%
pivot_wider(names_from = outcome, values_from = number)
View(check)
check <- care_outcomes_data %>%
filter(la_name == "Birmingham", cla_group == "Convictions: Children looked after Ages 10 to 17 years") %>%
mutate(number = ifelse(number == "c", 0, number)) %>%
mutate(number = as.numeric(number)) %>%
pivot_wider(id_cols = time_period, names_from = outcome, values_from = number)
check <- care_outcomes_data %>%
filter(la_name == "Birmingham", cla_group == "Convictions: Children looked after Ages 10 to 17 years") %>%
mutate(number = ifelse(number == "c", 0, number)) %>%
mutate(number = as.numeric(number)) %>%
pivot_wider(id_cols = time_period, names_from = outcome, values_from = number) %>%
mutate(`Not convicted, cautioned` = `Total ages 10 to 17 years` - `Convicted or subject to youth cautions, or youth conditional cautions during the year`)
check <- care_outcomes_data %>%
filter(la_name == "Birmingham", cla_group == "Convictions: Children looked after Ages 10 to 17 years") %>%
mutate(number = ifelse(number == "c", 0, number)) %>%
mutate(number = as.numeric(number)) %>%
pivot_wider(id_cols = time_period, names_from = outcome, values_from = number) %>%
mutate(`Not convicted, cautioned` = `Total ages 10 to 17 years` - `Convicted or subject to youth cautions, or youth conditional cautions during the year`) %>%
select(-`Total ages 10 to 17 years`) %>%
pivot_longer(!time_period, names_to = outcome, values_to = number)
check <- care_outcomes_data %>%
filter(la_name == "Birmingham", cla_group == "Convictions: Children looked after Ages 10 to 17 years") %>%
mutate(number = ifelse(number == "c", 0, number)) %>%
mutate(number = as.numeric(number)) %>%
pivot_wider(id_cols = time_period, names_from = outcome, values_from = number) %>%
mutate(`Not convicted, cautioned` = `Total ages 10 to 17 years` - `Convicted or subject to youth cautions, or youth conditional cautions during the year`) %>%
select(-`Total ages 10 to 17 years`) %>%
pivot_longer(!time_period, names_to = outcome, values_to = number)
check <- care_outcomes_data %>%
filter(la_name == "Birmingham", cla_group == "Convictions: Children looked after Ages 10 to 17 years") %>%
mutate(number = ifelse(number == "c", 0, number)) %>%
mutate(number = as.numeric(number)) %>%
pivot_wider(id_cols = time_period, names_from = outcome, values_from = number) %>%
mutate(`Not convicted, cautioned` = `Total ages 10 to 17 years` - `Convicted or subject to youth cautions, or youth conditional cautions during the year`) %>%
select(-`Total ages 10 to 17 years`) %>%
pivot_longer(!time_period, names_to = "outcome", values_to = "number")  %>%
ggplot() +
geom_area(aes(x = time_period, y = number,
group = outcome, fill = outcome),
colour = "black", size = .2) +
scale_x_continuous(name = "") +
scale_y_continuous(name = "") + # , expand = c(0, 0), limits = c(0, NA)
theme_classic() +
theme(strip.background = element_blank()) +
scale_fill_brewer(palette = "Blues")
care_outcomes_data %>%
filter(la_name == "Birmingham", cla_group == "Convictions: Children looked after Ages 10 to 17 years") %>%
mutate(number = ifelse(number == "c", 0, number)) %>%
mutate(number = as.numeric(number)) %>%
pivot_wider(id_cols = time_period, names_from = outcome, values_from = number) %>%
mutate(`Not convicted, cautioned` = `Total ages 10 to 17 years` - `Convicted or subject to youth cautions, or youth conditional cautions during the year`) %>%
select(-`Total ages 10 to 17 years`) %>%
pivot_longer(!time_period, names_to = "outcome", values_to = "number")  %>%
ggplot() +
geom_area(aes(x = time_period, y = number,
group = outcome, fill = outcome),
colour = "black", size = .2) +
scale_x_continuous(name = "") +
scale_y_continuous(name = "") + # , expand = c(0, 0), limits = c(0, NA)
theme_classic() +
theme(strip.background = element_blank()) +
scale_fill_brewer(palette = "Blues")
ggsave(filename = "Output/Graphs/birm_care_conviction.png")
# second dataset - missing
readin_data <- read.csv("/Users/katehayes/temp_data/children-looked-after-in-england-including-adoptions_2021/data/la_children_who_were_missing_or_away_from_placement_during_the_year.csv")
care_outcomes_data <- readin_data
check <- care_outcomes_data %>%
filter(la_name == "Birmingham") %>%
mutate(number = ifelse(number == "c", 0, number)) %>%
mutate(number = as.numeric(number))
check <- care_outcomes_data %>%
filter(la_name == "Birmingham") %>%
mutate(number = ifelse(number == "c" | number == "z", 0, number)) %>%
mutate(number = as.numeric(number)) %>%
pivot_wider(id_cols = time_period, names_from = cla_group, values_from = number)
View(check)
care_outcomes_data %>%
filter(la_name == "Birmingham") %>%
mutate(number = ifelse(number == "c" | number == "z", 0, number)) %>%
mutate(number = as.numeric(number)) %>%
pivot_wider(id_cols = time_period, names_from = cla_group, values_from = number) # %>%
care_outcomes_data %>%
filter(la_name == "Birmingham") %>%
mutate(number = ifelse(number == "c" | number == "z", 0, number)) %>%
mutate(number = as.numeric(number)) %>%
pivot_wider(id_cols = time_period, names_from = cla_group, values_from = number) %>%
mutate(`Did not go missing` = `Children looked after during the year` - `Children who had a missing incident during the year`,
`Went missing once` = `Children who had a missing incident during the year` - `Children who went missing more than once during the year`) %>%
select(time_period, `Did not go missing`, `Went missing once`, `Children who went missing more than once during the year`) %>%
pivot_longer(!time_period, names_to = "missing", values_to = "number")  %>%
ggplot() +
geom_area(aes(x = time_period, y = number,
group = missing, fill = missing),
colour = "black", size = .2) +
scale_x_continuous(name = "") +
scale_y_continuous(name = "") + # , expand = c(0, 0), limits = c(0, NA)
theme_classic() +
theme(strip.background = element_blank()) +
scale_fill_brewer(palette = "Blues")
care_outcomes_data %>%
filter(la_name == "Birmingham") %>%
mutate(number = ifelse(number == "c" | number == "z", 0, number)) %>%
mutate(number = as.numeric(number)) %>%
pivot_wider(id_cols = time_period, names_from = cla_group, values_from = number) %>%
mutate(`Did not go missing` = `Children looked after during the year` - `Children who had a missing incident during the year`,
`Went missing once` = `Children who had a missing incident during the year` - `Children who went missing more than once during the year`) %>%
select(time_period, `Did not go missing`, `Went missing once`, `Children who went missing more than once during the year`) %>%
pivot_longer(!time_period, names_to = "missing", values_to = "number")  %>%
mutate(missing = fct_relevel(missing, "Did not go missing", "Went missing once", "Children who went missing more than once during the year")) %>%
ggplot() +
geom_area(aes(x = time_period, y = number,
group = missing, fill = missing),
colour = "black", size = .2) +
scale_x_continuous(name = "") +
scale_y_continuous(name = "") + # , expand = c(0, 0), limits = c(0, NA)
theme_classic() +
theme(strip.background = element_blank()) +
scale_fill_brewer(palette = "Blues")
care_outcomes_data %>%
filter(la_name == "Birmingham") %>%
mutate(number = ifelse(number == "c" | number == "z", 0, number)) %>%
mutate(number = as.numeric(number)) %>%
pivot_wider(id_cols = time_period, names_from = cla_group, values_from = number) %>%
mutate(`Did not go missing` = `Children looked after during the year` - `Children who had a missing incident during the year`,
`Went missing once` = `Children who had a missing incident during the year` - `Children who went missing more than once during the year`) %>%
select(time_period, `Did not go missing`, `Went missing once`, `Children who went missing more than once during the year`) %>%
pivot_longer(!time_period, names_to = "missing", values_to = "number")  %>%
mutate(missing = fct_relevel(missing, "Children who went missing more than once during the year", "Went missing once", "Did not go missing")) %>%
ggplot() +
geom_area(aes(x = time_period, y = number,
group = missing, fill = missing),
colour = "black", size = .2) +
scale_x_continuous(name = "") +
scale_y_continuous(name = "") + # , expand = c(0, 0), limits = c(0, NA)
theme_classic() +
theme(strip.background = element_blank()) +
scale_fill_brewer(palette = "Blues")
care_outcomes_data %>%
filter(la_name == "Birmingham") %>%
mutate(number = ifelse(number == "c" | number == "z", 0, number)) %>%
mutate(number = as.numeric(number)) %>%
pivot_wider(id_cols = time_period, names_from = cla_group, values_from = number) %>%
mutate(`Did not go missing` = `Children looked after during the year` - `Children who had a missing incident during the year`,
`Went missing once` = `Children who had a missing incident during the year` - `Children who went missing more than once during the year`) %>%
select(time_period, `Did not go missing`, `Went missing once`, `Children who went missing more than once during the year`) %>%
pivot_longer(!time_period, names_to = "missing", values_to = "number")  %>%
mutate(missing = fct_relevel(missing, "Children who went missing more than once during the year", "Went missing once", "Did not go missing")) %>%
ggplot() +
geom_area(aes(x = time_period, y = number,
group = missing, fill = fct_rev(missing)),
colour = "black", size = .2) +
scale_x_continuous(name = "") +
scale_y_continuous(name = "") + # , expand = c(0, 0), limits = c(0, NA)
theme_classic() +
theme(strip.background = element_blank()) +
scale_fill_brewer(palette = "Blues")
care_outcomes_data %>%
filter(la_name == "Birmingham") %>%
mutate(number = ifelse(number == "c" | number == "z", 0, number)) %>%
mutate(number = as.numeric(number)) %>%
pivot_wider(id_cols = time_period, names_from = cla_group, values_from = number) %>%
mutate(`Did not go missing` = `Children looked after during the year` - `Children who had a missing incident during the year`,
`Went missing once` = `Children who had a missing incident during the year` - `Children who went missing more than once during the year`) %>%
select(time_period, `Did not go missing`, `Went missing once`, `Children who went missing more than once during the year`) %>%
pivot_longer(!time_period, names_to = "missing", values_to = "number")  %>%
mutate(missing = fct_relevel(missing, "Children who went missing more than once during the year", "Went missing once", "Did not go missing")) %>%
ggplot() +
geom_area(aes(x = time_period, y = number,
group = missing, fill = fct_rev(missing)),
colour = "black", size = .2) +
scale_x_continuous(name = "") +
scale_y_continuous(name = "") + # , expand = c(0, 0), limits = c(0, NA)
theme_classic() +
theme(strip.background = element_blank()) +
scale_fill_brewer(palette = "PuRd")
ggsave(filename = "Output/Graphs/birm_care_missing.png")
#########rNEW DATA - repeat episodes of care######################################################################################################
readin_data <- read.csv("/Users/katehayes/temp_data/children-looked-after-in-england-including-adoptions_2021/data/national_cla_ceased_during_year_placements_care_periods.csv")
care_repeat_data <- readin_data
care_repeat_data %>%
filter(cla_group == "Number of periods of care", periods_or_placements != "Total",
periods_or_placements != "10 or more",
age_on_ceasing != "Total",  age_on_ceasing != "Under 1 year",  age_on_ceasing != "1 to 4 years",  age_on_ceasing != "5 to 9 years",) %>%
group_by(age_on_ceasing, periods_or_placements, time_period) %>%
mutate(number = as.numeric(number)) %>%
summarise(number = number) %>%
mutate(number = if_else(is.na(number), 0, number)) %>%
ggplot() +
geom_line(aes(x = periods_or_placements, y = number,
group = age_on_ceasing, colour = age_on_ceasing)) +
facet_wrap(~time_period) +
scale_x_discrete(name = "") +
scale_y_continuous(name = "") +
theme_classic() +
theme(strip.background = element_blank(), axis.text.x=element_text(angle = -35, hjust = 0)) +
scale_colour_viridis(option = "viridis", discrete = TRUE)
